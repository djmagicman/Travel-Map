<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Простой вход</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  #authContainer, #profileContainer { max-width: 300px; margin: auto; }
  #profileContainer { display: none; }
  input, button { display: block; width: 100%; margin: 10px 0; padding: 10px; }
</style>
</head>
<body>

<div id="authContainer">
  <h2 id="authTitle">Вход</h2>
  <input type="tel" id="phoneInput" placeholder="Номер телефона" />
  <input type="password" id="passwordInput" placeholder="Пароль" />
  <button id="authBtn">Войти</button>
  <div id="authMessage" style="color:red;"></div>
  <div><a href="#" id="toggleAuth">Нет аккаунта? Зарегистрироваться</a></div>
</div>

<div id="profileContainer">
  <h2>Профиль пользователя</h2>
  <p>Вы вошли как: <span id="userPhone"></span></p>
  <button id="logoutBtn">Выйти</button>
</div>

<script>
  let isLogin = true;
  let users = JSON.parse(localStorage.getItem('users') || '[]');
  let currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');

  const authContainer = document.getElementById('authContainer');
  const profileContainer = document.getElementById('profileContainer');
  const authTitle = document.getElementById('authTitle');
  const phoneInput = document.getElementById('phoneInput');
  const passwordInput = document.getElementById('passwordInput');
  const authBtn = document.getElementById('authBtn');
  const authMessage = document.getElementById('authMessage');
  const toggleAuth = document.getElementById('toggleAuth');
  const userPhoneSpan = document.getElementById('userPhone');
  const logoutBtn = document.getElementById('logoutBtn');

  function showProfile() {
    authContainer.style.display = 'none';
    profileContainer.style.display = 'block';
    userPhoneSpan.textContent = currentUser.phone;
  }

  function showAuth() {
    authContainer.style.display = 'block';
    profileContainer.style.display = 'none';
    authMessage.textContent = '';
    phoneInput.value = '';
    passwordInput.value = '';
  }

  toggleAuth.addEventListener('click', e => {
    e.preventDefault();
    isLogin = !isLogin;
    if (isLogin) {
      authTitle.textContent = 'Вход';
      authBtn.textContent = 'Войти';
      toggleAuth.textContent = 'Нет аккаунта? Зарегистрироваться';
    } else {
      authTitle.textContent = 'Регистрация';
      authBtn.textContent = 'Зарегистрироваться';
      toggleAuth.textContent = 'Уже есть аккаунт? Войти';
    }
    authMessage.textContent = '';
  });

  authBtn.addEventListener('click', () => {
    const phone = phoneInput.value.trim();
    const password = passwordInput.value.trim();
    authMessage.textContent = '';

    if (!phone || !password) {
      authMessage.textContent = 'Пожалуйста, введите номер телефона и пароль.';
      return;
    }

    if (isLogin) {
      // Вход
      const user = users.find(u => u.phone === phone && u.password === password);
      if (user) {
        currentUser = user;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        showProfile();
      } else {
        authMessage.textContent = 'Неверный номер телефона или пароль.';
      }
    } else {
      // Регистрация
      if (users.find(u => u.phone === phone)) {
        authMessage.textContent = 'Пользователь с таким номером уже зарегистрирован.';
        return;
      }
      const newUser = { phone, password };
      users.push(newUser);
      localStorage.setItem('users', JSON.stringify(users));
      currentUser = newUser;
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      showProfile();
    }
  });

  logoutBtn.addEventListener('click', () => {
    currentUser = null;
    localStorage.removeItem('currentUser');
    showAuth();
  });

  // При загрузке проверяем, если пользователь в сессии — показываем профиль
  if (currentUser) {
    showProfile();
  } else {
    showAuth();
  }
</script>

</body>
</html>
